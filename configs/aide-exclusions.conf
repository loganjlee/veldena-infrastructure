# AIDE Custom Exclusions
# Reduces false positives and scan time while keeping detection on critical paths
#
# Design: exclude paths that change constantly during normal operations
# and are already monitored by other tools. Keep watching anything an
# attacker would need to modify for persistence or exfiltration.
#
# What AIDE still monitors (the important stuff):
#   /usr/bin, /usr/sbin    - system binaries (rootkit detection)
#   /etc/                  - all config files
#   /home/ubuntu/.ssh/     - authorized keys (unauthorized access)
#   /etc/cron.d/           - scheduled tasks (persistence)
#   /etc/nginx/            - web server config (redirect attacks)
#   kernel modules         - rootkit loading

# Docker volumes: PostgreSQL writes stats every 5 minutes, which
# generates thousands of false positives per day. Container health
# is monitored separately by server-monitor.sh (every 15 min).
!/var/lib/docker/volumes
!/var/lib/docker/overlay2
!/var/lib/docker/containers

# Log files: grow continuously by design. Already monitored by
# Fail2Ban (auth.log), server-monitor.sh (nginx), and weekly-report.sh.
!/var/log/nginx
!/var/log/amazon
!/var/log/msmtp.log

# Fail2Ban database: updates every time it processes a log entry.
# Fail2Ban service health is checked by server-monitor.sh.
!/var/lib/fail2ban

# AIDE's own database: changes every init/update cycle.
!/var/lib/aide

# Bash history: changes with every command typed.
!/home/ubuntu/.bash_history

# Monitoring script logs: written every 15 minutes by cron jobs.
!/home/ubuntu/.*\.log$

# Temp files: ephemeral by design, cleared on reboot.
!/tmp
!/var/tmp
!/run
